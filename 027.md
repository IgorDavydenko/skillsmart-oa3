27. Замечание про композицию и ссылки на объекты
Важный момент в процессе моделирования, когда мы пытаемся абстрагироваться от реализации (практики, максимально удалённой от исходной модели на базе АТД, которая наиболее близка к "реальности") -- это понимание композиции как составного объекта. Тут всегда исходим из того, что в родительский объект другие объекты вложены "физически", то есть мы не рассматриваем их как объекты, "физически" связанные через ссылки. Понятие программных ссылок на верхнем уровне моделирования отсутствует.

Тут имеется определённая концептуальная проблема, связанная с тем, что на фазе реализации активно применяется концепция ссылок на объекты (и в том числе обычны ситуации, когда много переменных указывают на один и тот же объект), однако на этапах анализа и проектирования мы их принципиально избегаем. В то же время популярные структуры данных (например, списки и деревья) практически во всей классической литературе определяются через понятие ссылки (ссылки на следующий и предыдущий узлы, на родительский и дочерние, и т. д.).

И эта проблема ставит под сомнение вообще саму возможность систематического подхода к моделированию с помощью ООП. Но и разрешается она просто -- прагматически.

Объектно-ориентированный подход -- это прежде всего повторное использование. Поэтому как только в некотором проекте возникает потребность какого-то достаточно сложного и запутанного манипулирования ссылками между объектами, это просто верный признак плохого проектирования.

Так как у нас в проекте имеются только классы, соответственно, ненужное манипулирование ссылками подразумевает какие-то странные, подозрительные физические операции, определённые за рамками этих классов (а эти классы сами по себе всегда модели конкретных структур данных). Но во-первых, в 90% случаев можно воспользоваться стандартными библиотеками, где определены почти все мыслимые часто используемые структуры данных (деревья, стеки, графы, очереди, хэш-таблички...), где вся работа со ссылками скрыта внутри них. Всегда можно соответствующие стандартные классы унаследовать и аккуратно расширить или переопределить их возможности.

Во-вторых, если возникает потребность в какой-то действительно достаточно сложной и оригинальной структуре данных, для которой в стандартных библиотеках подходящего аналога или основы не находится, то это признак, что данная структура как раз и выступает как некий универсальный тип данных. Поэтому её надо особо тщательно продумать и реализовать в качестве нового типа данных, добавляемого в стандартную библиотеку (фундаментальный принцип повторного использования), максимально избегая добавления лишних сущностей наподобие ссылок. В качестве эталонных примеров можно ориентироваться на реализации структур данных из стандартной библиотеки. В исключительных ситуациях, связанных с использованием внешних компонентов, необходимые операции работы с ссылками надо реализовать максимально безопасно и наглядно.
